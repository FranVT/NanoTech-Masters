\chapter{Patchy particle scheme for hydrophilic polymeric networks}

Now that we have covered the theoretical framework, we can delve into the numerical tools that will help us find relations between the polymeric network and the mechanical response.
First, we will describe the patchy particle scheme for simulating PNIPAM cross-linked networks.
Then, we will describe the numerical simulation protocol.
Next, we will introduce the LAMMPS package and explain how it can be used to simulate these systems.
Finally, we will present and analyze the simulation results.

\section{Simulation protocol}

One of the microgels that has been the focus of significant research is the type that is based on PNIPAM cross-linked networks.
In the article \textit{In silico Synthesis of Microgel Particles}, the authors present a flexible numerical protocol capable of designing individual microgel particles based on PNIPAM corr-linked networks. 
This protocol can generate particles with properties comparable to the experimental ones.
In this project, we employ a similar protocol to explore its versatility and identify a numerical tool that can facilitate connections between network configuration and mechanical response.

Our primary focus is on creating networks without spherical confinement and without mimicking the swelling behavior of PINIPAM microgels with temperature.
Therefore, the central strategy involves the implementation of a binary mixture of patchy particles to generate a disroded polymeric network structure, followed by the application of shear deformation.
The primary benefit of this protocol is that previous numerical efforts in microgel modeling have predominantly concentrated on unrealistic networks consisting of chains of equivalent length, frequently establishing cross-linked connections on crystalline lattice regions or where closed polymer networks are assembled by directly integrating randomly dispersed cross-linkers with polymer chains.

\subsection{Patchy particles representation}

A patchy particle\citep{bianchiPhaseDiagramPatchy2006,bianchiTheoreticalNumericalStudy2008} can be defined as a sphere with radius $r$ containing $n$ spheres of radius $l<r$ on its surface.
The smaller spheres are typically referred to as ``patches'' and the number of patches is often refer to as ``functionality''.
The center of the patches can be placed on the surface of the central particle. 
However, it can also be modified to be at a point inside the enclosed volume of the main particle.

The implementation of patchy particles as monomers and crosslinkers is a highly effective strategy.
This is due to the fact that it facilitates the integration of the infinitesimal representation by the Langevin dynamics with a particle that possesses volume and functionality.
The functionality representation is important because it allows for the representation of the monomer and cross-linker molecules that can form a polymeric network.
However, it is important to recognize that the geometry of the monomers and functional groups is assume to be spherical.

Finally, to define the volume of the particle, a repulsive pairwise interaction is defined between the central particles.
Meanwhile, to the formation of a polymeric network is facilitated by an attractive pairwise interaction defined between patches.
Because this model is designed to simulate the final network, not the synthesis process, the pairswise interaction between central particles and patches is not defined.

In contrast, the softness explain by particle interactions is characterized by the form of the repulsive pair potential between two particles.
Finally, the particle volume fraction contributes to the ability of the particles to deform or compress, in contrast to hard spheres\footnote{The patchy particles are hard spheres, but the hydrogel network is a soft ``particle''}\citep{vlassopoulosTunableRheologyDense2014}.

\subsection{Description of the system}

\paragraph{Interaction potentials} We start by describing the interaction potentials between patchy particles.
The interaction between the central particles is modeled with a Weeks-Chandler-Andersen repulsive potential,
\begin{gather}
    U_{WCA}(r_{i,j}) =\left\{ 
        \begin{array}{ll}
            4\epsilon_{i,j}\left[\qty(\frac{\sigma}{r_{i,j}})^{12}-\qty(\frac{\sigma}{r_{i,j}})^6\right]+\epsilon_{i,j}, & r_{i,j}\in[0,2^{1/6}\sigma], \\
            0, & r_{i,j}>2^{1/6}\sigma
        \end{array}
\right.
    ,\label{eqn:CL-MO_interaction}
\end{gather}
where $r_{i,j}$ is the distance between the center of the central particles, $\sigma$ is the diameter of the particles and $\epsilon_{i,j}$ is the energy of the interacton.
On the other hand, the patch-patch interaction is modeled with an attractive potential,
\begin{gather}
    U_{\mathrm{patchy}}\qty(r_{\mu\upsilon}) = \left\{
        \begin{array}{ll}
            2\epsilon_{\mu\upsilon}\left(\frac{\sigma_p^4}{2 r_{\mu\upsilon}^4}-1\right)\exp\left[\frac{\sigma_p}{\qty(r_{\mu\upsilon}-r_{c})}+2\right], & r_{\mu\upsilon}\in\qty[0,r_c], \\
            0, & r_{\mu,\upsilon}>r_c,
        \end{array}
            \right.\label{eqn:patch-patch_interaction}
\end{gather}
where $r_{\mu\upsilon}$ is the distance between two patches, $\sigma_p$ is the diameter of the patches, $r_c$ is the cut distance of interaction set to $1.5\sigma_p$ and $\epsilon_{\mu,\upsilon}$ is the interaction energy between the patches.
This potential can be interpreted as a reversible interaction.

It is important to say that if we let the polymeric network form with only those potentials, the patches are going to form cluster of more then 2 patches, which is not desirble since this will mean that every single monomer can be a crossliker\footnote{Mejorar este enunciado/idea}.
Hence, the interaction between patches is complemented by a three-body repulsive potential, defined in terms of~\eqref{eqn:patch-patch_interaction}, that provides an efficient bond-swapping mechanism making possible to easily equilibrate the system at extremely low temperatures, while at the same time, reataining the single-bond-per-patch condition\citep{sciortinoThreebodyPotentialSimulating2017},
\begin{gather}
    U_{\mathrm{swap}}(r_{l,m},r_{l,n}) = w\sum_{l,m,n}\epsilon_{m,n}U_3\qty(r_{l,m})U_3\qty(r_{l,n}),\quad r_{l,n}\in\qty[0,r_c],\label{eqn:swap_interaction}
\end{gather}
where
\begin{gather}
    U_{3}\qty(r) = \left\{
        \begin{array}{ll}
            1 & r\in\qty[0,r_{\min}], \\
            -U_{\mathrm{patchy}}\qty(r)/\epsilon_{m,n}, & r\in\qty[r_{\min},r_c]
        \end{array}
        \right.\label{eqn:swapmod_interaction}.
\end{gather}
The sum in~\eqref{eqn:swap_interaction} runs over all triples of bonded patches (patch $l$ bonded both with $m$ and $n$).
$r_{l,m}$ and $r_{l,n}$ are the distances between the reference patch and the other two patches.
The parameter $\epsilon_{m,n}$ is the energy of repulsion and $w$ is used to tuned the swapping ($w=1$) and non-swapping bonds ($w\gg1$). 
The cut off distance $r_c$ is the same as in the potential of interaction between patches, meanwhile the minimum distance $r_{\min}$ is the distance at the minimum of~\eqref{eqn:patch-patch_interaction}, \textit{i.e.} $\epsilon_{m,n}\equiv\abs{U_{\mathrm{patchy}}(r_{\min})}$.
Finally, the energy of interaction between crosslinker patches ($\epsilon_{\mu^i,\mu^i}$) are set to $0$ to allow only crosslinker-monomer and monomer-monomer bonding (figure~\ref{fig:intento2}).


\paragraph{Physical Parameters} Particle size, box length, packing fraction, temperature.

\paragraph{Deformation protocol} Constant shear rate, vary shear rate between simulations.
First goes the assembly protocol then the shear deformation.
Go beyond the elastic limit to see what's up.

\section{LAMMPS}

LAMMPS (Large-scale Atomic/Molecular Massively Parallel Simulator) is a highly flexible, open-source molecular dynamics software solution used for simulating atomic, molecular, and mesoscale systems. 
And is widely recognized for its extensibility, complete documentation, and active support in scientific communities focused on materials modeling and molecular simulation.
It is designed to efficiently model materials science, chemistry, and physics problems by enabling large-scale simulations on parallel computing architectures.
Furthermore, its parallelized structure allows efficient computation of large or complex systems, and supports integration with other computational tools and machine learning methods.

To define a simulation with this software we need to create an input script.
This input script is defined as a series of lines, with each line beginning with a command name and followed by one or more arguments separated by whitespace.
The program incorporates programming commands that define variables, perform conditional tests, execute loops, or invoke shell commands to launch an external program.
The input script is parsed and executed one line at a time. 
This feature allows a single script to run a simulation in stages, alter one or more parameters between stages, or run a series of independent simulations where the entire system is reinitialized multiple times.

\begin{itemize}
    \item \verb|table| command
    \item \verb|langevin| command
    \item \verb|threebody| command
    \item \verb|boundary| command
\end{itemize}

\subsection{Three-body potential}

%An importante technica issue to address is the tabulation of the threebody potential to introduce the swap potential into LAMMPS.
This is because the forces on all three particles $I$, $J$, and $K$ of a triplet of this type of three-body interaction potential lie within the plane defined by the three inter-particle distance vectors $\vec{r}_{IJ}$, $\vec{r}_{IK}$ and $\vec{r}_{JK}$.
This property is used to project the forces onto the inter-particle distance vectors.
Hence, we need to create a table taking that into consideration, for that we \textbf{\ldots}

\section{Results}

\subsection{Mechanical response}

Strain stress graph

\begin{figure}[ht!]
    \centering
    \includegraphics[width=\textwidth]{figs/ComputaitonalResults/strain-vs-stressxy.png}
    \caption{results from computational results test}
\end{figure}


\subsection{Network analysis}

I guess that figures of the final network and parameter of order or size of porous or whatever.

